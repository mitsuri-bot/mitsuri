let handler = async (m, { conn, command, text }) => {
  let user = global.db.data.users[m.sender];
  if (!user) {
      user = global.db.data.users[m.sender];
  }

  const startGame = async () => {
      let secretNumber = Math.floor(Math.random() * 100) + 1;
      user.guessGame = {
          secretNumber: secretNumber,
          attempts: 0,
          maxAttempts: 10,
          started: true
      };

      await conn.reply(m.chat, 'ØªÙ… Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù…! Ø­Ø§ÙˆÙ„ ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù… Ø¨ÙŠÙ† 1 Ùˆ100. Ù„Ø¯ÙŠÙƒ 10 Ù…Ø­Ø§ÙˆÙ„Ø§Øª.', m);
  };

  const endGame = async (guess) => {
      let game = user.guessGame;
      if (!game || !game.started) {
          return conn.reply(m.chat, 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø¹Ø¨Ø© Ø¬Ø§Ø±ÙŠØ© Ø­Ø§Ù„ÙŠØ§Ù‹. Ø§Ø¨Ø¯Ø£ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ø±: "Ø±Ù‚Ù…_Ø³Ø±ÙŠ"', m);
      }

      guess = parseInt(guess);
      if (isNaN(guess) || guess < 1 || guess > 100) {
          return conn.reply(m.chat, 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ø¨ÙŠÙ† 1 Ùˆ100.', m);
      }

      game.attempts++;

      if (guess === game.secretNumber) {
          user.exp += 100;
          await conn.reply(m.chat, `ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù„Ù‚Ø¯ Ø®Ù…Ù†Øª Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­ ÙˆÙ‡Ùˆ ${game.secretNumber}. Ù„Ù‚Ø¯ Ø±Ø¨Ø­Øª 100 XP.`, m);
          user.guessGame = {}; 
      } else if (game.attempts >= game.maxAttempts) {
          await conn.reply(m.chat, `Ù„Ù‚Ø¯ Ø§Ù†ØªÙ‡Øª Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ! Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­ ÙƒØ§Ù† ${game.secretNumber}. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!`, m);
          user.guessGame = {}; 
      } else {
          let hint = guess < game.secretNumber ? 'Ø£Ø¹Ù„Ù‰' : 'Ø£Ù‚Ù„';
          await conn.reply(m.chat, `ØªØ®Ù…ÙŠÙ†Ùƒ ØºÙŠØ± ØµØ­ÙŠØ­! Ø­Ø§ÙˆÙ„ Ø±Ù‚Ù… ${hint}.`, m);
      }
  };

  const showHelp = async () => {
      const helpMessage = `
â€â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯â€¢â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®*

> *ââ”‡Ø´Ù€Ù€Ø±Ø­ Ù„Ù€Ø¹Ù€Ù€Ø¨Ù€Ø© ØªÙ€Ù€Ø®Ù€Ù€Ù…Ù€ÙŠÙ€Ù† Ø§Ù„Ù€Ø±Ù‚Ù€Ù…*

> *â€â”‡Ø¨Ù€Ù€Ø¯Ø¡ Ø§Ù„Ù€Ù„Ù€Ø¹Ø¨Ù€Ø© :*
> *- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ù…Ø± â”‡ Ø±Ù‚Ù€Ù€Ù…_Ø³Ù€Ù€Ø±ÙŠ â”‡ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©*
> *- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø±Ù‚Ù… Ø³Ø±ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 1 Ùˆ100*
*â¸»â¸»â¸»â¸»â¸»â¸»â¸»â¸»*
> *ââ”‡Ø§Ù„Ù€ØªÙ€Ø®Ù€Ù…Ù€Ù€ÙŠÙ€Ù†*:
> *- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ù…Ø± ØªØ®Ù…ÙŠÙ† Ø±Ù‚Ù… Ù„Ø¥Ø¯Ø®Ø§Ù„ ØªØ®Ù…ÙŠÙ†Ùƒ*
> *- Ø³ØªØªÙ„Ù‚Ù‰ ØªÙ„Ù…ÙŠØ­Ù‹Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø£Ø¹Ù„Ù‰ Ø£Ùˆ Ø£Ù‚Ù„*
*â¸»â¸»â¸»â¸»â¸»â¸»â¸»â¸»*
> *â‚â”‡Ø§Ù„ÙÙˆØ² ÙˆØ§Ù„Ø®Ø³Ø§Ø±Ø© :*
> *- Ù„Ø¯ÙŠÙƒ 10 Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù„ØªØ®Ù…ÙŠÙ† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­*
> *- Ø¥Ø°Ø§ Ø®Ù…Ù†Øª Ø§Ù„Ø±Ù‚Ù… Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ØŒ Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ 100 Ù†Ù‚Ø·Ø© Ø®Ø¨Ø±Ø© (XP)*
> *- Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ù…Ø­Ø§ÙˆÙ„Ø§ØªÙƒ Ø¯ÙˆÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø±Ù‚Ù… Ø§Ù„ØµØ­ÙŠØ­ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§!*
*â¸»â¸»â¸»â¸»â¸»â¸»â¸»â¸»*
> *ââ”‡Ù†Ù€ØµÙ€Ø§Ø¦Ù€Ù€ğŸ“œÙ€Ù€Ø­ :*
> *- Ø­Ø§ÙˆÙ„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø¨Ø°ÙƒØ§Ø¡ Ù„Ù„ÙˆØµÙ„ Ù„Ù„Ø±Ù‚Ù… Ø¨Ø£Ù‚Ù„ Ù…Ø­Ø§ÙˆÙ„Ø§Øª.*
> *- Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ´Ø§Ø±ÙƒÙ‡Ø§ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ!*
*â¸»â¸»â¸»â¸»â¸»â¸»â¸»â¸»*
> *Ø£ÙˆØ§Ù…Ù€Ø± Ø§Ù„Ù€Ù„Ù€Ø¹Ù€Ø¨Ù€Ù€Ø©:*
> *ã€„â”‡Ø±Ù‚Ù€Ù…_Ø³Ù€Ø±ÙŠ : Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©.*
> *ã€„â”‡ØªØ®Ù…ÙŠÙ† [Ø±Ù‚Ù…] : Ù„Ø¥Ø¯Ø®Ø§Ù„ ØªØ®Ù…ÙŠÙ†Ùƒ.*
> *ã€„â”‡Ø´Ø±Ø­ : Ù„Ø¹Ø±Ø¶ Ù‡Ø°Ø§ Ø§Ù„Ø´Ø±Ø­ Ù…Ø¬Ø¯Ø¯Ù‹Ø§.*
`;
      await conn.reply(m.chat, helpMessage, m);
  };

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
  if (command === 'Ø±Ù‚Ù…_Ø³Ø±ÙŠ') {
      await startGame();
  } else if (command === 'ØªØ®Ù…ÙŠÙ†') {
      await endGame(text.trim());
  } else if (command === 'Ø´Ø±Ø­') {
      await showHelp();
  }
};

handler.help = ['Ø±Ù‚Ù…_Ø³Ø±ÙŠ', 'ØªØ®Ù…ÙŠÙ† [Ø±Ù‚Ù…]', 'Ø´Ø±Ø­'];
handler.tags = ['game'];
handler.command = ['Ø±Ù‚Ù…_Ø³Ø±ÙŠ', 'ØªØ®Ù…ÙŠÙ†', 'Ø´Ø±Ø­'];

export default handler;

Ù…Ù„Ø§Ø­Ø¸Ù‡ Ù…Ù…Ù†ÙˆØ¹ ØªØºÙŠØ± Ø­Ù‚ÙˆÙ‚ Ø¹Ù…ÙƒÙ… Ø²ÙŠØ±ÙŠÙ
